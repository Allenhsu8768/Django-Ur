(function(e){function t(t){for(var o,s,i=t[0],c=t[1],u=t[2],p=0,f=[];p<i.length;p++)s=i[p],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&f.push(a[s][0]),a[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);l&&l(t);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(o=!1)}o&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},a={app:0},r=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},1837:function(e,t,n){},"45db":function(e,t,n){"use strict";n("1837")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("img",{attrs:{alt:"Vue logo",src:n("cf05")}}),o("index")],1)},r=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("首頁")]),e.flag?e._e():n("h1",[e._v("歡迎:"+e._s(e.login_name))]),n("h1",[e._v("djanog-jwt token 設置")]),e.flag?n("form",{attrs:{action:"#",method:"post"}},[e._v(" 帳號: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",name:"username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),e._v(" 密碼: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",name:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),n("button",{attrs:{type:"button"},on:{click:e.login}},[e._v("登入")])]):e._e(),n("button",{attrs:{type:"button"},on:{click:e.check_login}},[e._v("點我看 log ")]),n("h1",[e._v("django-simple-jwt 設置")]),e.flag?n("form",{attrs:{action:"#",method:"post"}},[e._v(" 帳號: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.username_simple,expression:"username_simple"}],attrs:{type:"text",name:"username_simple"},domProps:{value:e.username_simple},on:{input:function(t){t.target.composing||(e.username_simple=t.target.value)}}}),e._v(" 密碼: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password_simple,expression:"password_simple"}],attrs:{type:"password",name:"password_simple"},domProps:{value:e.password_simple},on:{input:function(t){t.target.composing||(e.password_simple=t.target.value)}}}),n("button",{attrs:{type:"button"},on:{click:e.login_simple_jwt}},[e._v("登入")])]):e._e(),n("button",{attrs:{type:"button"},on:{click:e.check_login_simple_jwt}},[e._v("點我看 log ")]),n("button",{attrs:{type:"button"},on:{click:e.refresh_token}},[e._v("點我刷新token")]),n("button",{attrs:{type:"button"},on:{click:e.loginout}},[e._v("登出")])])},i=[],c=(n("d3b7"),n("99af"),n("bc3a")),u=n.n(c);function l(){return u.a.post("http://127.0.0.1:8000/simple-jwt-token/refresh/",{refresh:localStorage.getItem("refresh_token")})}u.a.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),u.a.interceptors.response.use((function(e){return e}),(function(e){if(401===e.response.status){var t="http://127.0.0.1:8000/simple-jwt-token/refresh/";if(e.config.url!==t)return l().then((function(t){return localStorage.setItem("acess_token",t.data.access),e.config.headers.Authorization="Bearer "+t.data.access,u()(e.config)})).catch((function(e){return console.log("抱歉您的token 已經失效!"),Promise.reject(e)}))}}));var p=u.a,f={name:"index",data:function(){return{username:"",password:"",username_simple:"",password_simple:"",flag:!0,base_url:"http://127.0.0.1:8000/"}},methods:{check_login:function(){var e=this;p.get("http://127.0.0.1:8000/index/").then((function(t){e.login_name=t.data.username,e.flag=!1})).catch((function(t){console.log(t),e.flag=!0}))},login:function(){var e=this,t="http://127.0.0.1:8000/login/";p.post(t,{username:this.username,password:this.password}).then((function(t){200===t.data.status?(e.login_name=t.data.data.username,e.flag=!1,localStorage.setItem("token",t.data.data.token)):console.log(t.data)})).catch((function(e){return alert(e+"請重新登入")}))},refresh_token:function(){fetch(this.base_url+"simple-jwt-token/refresh/",{method:"POST",body:JSON.stringify({refresh:localStorage.getItem("refresh_token")}),headers:{"Content-Type":"application/json;charset=utf-8"}}).then((function(e){return 401===e.status&&alert("token過期!"),e.json()})).then((function(e){localStorage.setItem("acess_token",e.access),alert("獲取到新的 token : ".concat(e.access))})).catch((function(e){console.log(e)}))},check_login_simple_jwt:function(){var e=this;p.get(this.base_url+"index_2",{headers:{Authorization:"Bearer "+localStorage.getItem("acess_token")}}).then((function(t){e.login_name=t.data.user_name,e.flag=!1})).catch((function(e){alert("您的 token 已經失效!"),console.log("token 已經失效",e.response.status)}))},login_simple_jwt:function(){var e=this;p.post(this.base_url+"login2/",{username:this.username_simple,password:this.password_simple}).then((function(t){200===t.data.status&&(alert("acess_token: ".concat(t.data.data.access_token," , refresh_token: ").concat(t.data.data.refresh_token)),localStorage.setItem("acess_token",t.data.data.access_token),localStorage.setItem("refresh_token",t.data.data.refresh_token),e.login_name=t.data.data.user_name,e.flag=!1)}))},loginout:function(){}}},m=f,d=(n("45db"),n("2877")),g=Object(d["a"])(m,s,i,!1,null,null,null),_=g.exports,h={name:"App",components:{index:_}},v=h,b=(n("034f"),Object(d["a"])(v,a,r,!1,null,null,null)),w=b.exports;o["a"].config.productionTip=!1,new o["a"]({render:function(e){return e(w)}}).$mount("#app")},"85ec":function(e,t,n){},cf05:function(e,t,n){e.exports=n.p+"static/img/logo.82b9c7a5.png"}});
//# sourceMappingURL=app.774f71a0.js.map